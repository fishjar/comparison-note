<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>è‡ªåŠ¨åŒ–æµ‹è¯•</title><link rel="preload" href="/comparison-note/_next/static/css/dc4eece8d63e31b4b040.css" as="style"/><link rel="stylesheet" href="/comparison-note/_next/static/css/dc4eece8d63e31b4b040.css" data-n-g=""/><link rel="preload" href="/comparison-note/_next/static/css/05437c60348a21355b6c.css" as="style"/><link rel="stylesheet" href="/comparison-note/_next/static/css/05437c60348a21355b6c.css" data-n-g=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/comparison-note/_next/static/chunks/main-14614ae8e939b9e5961e.js" as="script"/><link rel="preload" href="/comparison-note/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/comparison-note/_next/static/chunks/framework.c7b20b4e446c7cca89e7.js" as="script"/><link rel="preload" href="/comparison-note/_next/static/chunks/7945cc82.ff5578978733a40a67a3.js" as="script"/><link rel="preload" href="/comparison-note/_next/static/chunks/commons.a32a113e095d8f0b1079.js" as="script"/><link rel="preload" href="/comparison-note/_next/static/chunks/pages/_app-1832d2b05f1f19d6a06d.js" as="script"/><link rel="preload" href="/comparison-note/_next/static/chunks/a1bc03cf.64f9f8493143216945e6.js" as="script"/><link rel="preload" href="/comparison-note/_next/static/chunks/4d6c67b811e74d3ca6630b1db854b02fef4ff3ce.8a4303f940dd12850a8f.js" as="script"/><link rel="preload" href="/comparison-note/_next/static/chunks/pages/%5B...param%5D-ec17b069b047a5ce78c3.js" as="script"/></head><body><div id="__next"><nav class="navbar navbar-expand-lg navbar-light bg-light"><a href="/comparison-note/" class="navbar-brand">å¯¹æ¯”å­¦ä¹ ç¬”è®°</a><button aria-controls="basic-navbar-nav" type="button" aria-label="Toggle navigation" class="navbar-toggler collapsed"><span class="navbar-toggler-icon"></span></button><div class="navbar-collapse collapse" id="basic-navbar-nav"><div class="mr-auto navbar-nav"><a href="/comparison-note/algorithm" data-rb-event-key="/algorithm" class="nav-link">æ•°æ®ç»“æ„å’Œç®—æ³•</a><a href="/comparison-note/basic-concept" data-rb-event-key="/basic-concept" class="nav-link">åŸºç¡€æ¦‚å¿µ</a><a href="/comparison-note/data-type" data-rb-event-key="/data-type" class="nav-link">æ•°æ®ç±»å‹</a><a href="/comparison-note/special" data-rb-event-key="/special" class="nav-link">ä¸“é¢˜</a></div></div></nav><div style="padding-top:12px;padding-bottom:12px" class="container-fluid"><h1>è‡ªåŠ¨åŒ–æµ‹è¯•</h1><div style="margin-bottom:12px"><div class="markdown-body"></div></div><div style="margin-bottom:12px" class="justify-content-md-center row"><div class="col-md-auto"><div role="toolbar" class="btn-toolbar"><div role="group" class="btn-group btn-group-sm btn-group-toggle"><label class="btn btn-secondary"><input type="checkbox" value="go" autoComplete="off"/>go</label><label class="btn btn-secondary"><input type="checkbox" value="rust" autoComplete="off"/>rust</label></div></div></div></div><div class="card-group"></div></div><div style="text-align:center;padding:12px 0;font-size:14px">v<!-- -->0.1.0<!-- --> <a href="https://github.com/fishjar/comparison-note" title="è®¿é—®githubæºç ">github</a></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"nav":{"name":"test","fullPath":"/special/test","asPath":"/special/test","id":"%2Fspecial%2Ftest","parent":{"name":"special","fullPath":"/special","asPath":"/special","id":"%2Fspecial","readme":{"title":"ä¸“é¢˜","fullPath":"/special/README.md"}},"readme":{"title":"è‡ªåŠ¨åŒ–æµ‹è¯•","fullPath":"/special/test/README.md"},"cards":[{"name":"go.md","baseName":"go","extName":".md","fullPath":"/special/test/go.md"},{"name":"rust.md","baseName":"rust","extName":".md","fullPath":"/special/test/rust.md"}],"nodes":[]},"content":"","cards":[{"name":"go.md","baseName":"go","extName":".md","fullPath":"/special/test/go.md","content":"## ä¸€ä¸ªä¾‹å­\n\n```sh\nexample/\n   |--calc.go\n   |--calc_test.go\n```\n\n```go\n// calc.go\npackage main\n\nfunc Add(a int, b int) int {\n    return a + b\n}\n\nfunc Mul(a int, b int) int {\n    return a * b\n}\n```\n\n```go\n// calc_test.go\npackage main\n\nimport \"testing\"\n\nfunc TestAdd(t *testing.T) {\n\tif ans := Add(1, 2); ans != 3 {\n\t\tt.Errorf(\"1 + 2 expected be 3, but %d got\", ans)\n\t}\n\n\tif ans := Add(-10, -20); ans != -30 {\n\t\tt.Errorf(\"-10 + -20 expected be -30, but %d got\", ans)\n\t}\n}\n```\n\n```sh\n# æ‰§è¡Œæ‰€æœ‰æµ‹è¯•ç”¨ä¾‹\n$ go test -v\n=== RUN   TestAdd\n--- PASS: TestAdd (0.00s)\n=== RUN   TestMul\n--- PASS: TestMul (0.00s)\nPASS\nok      example 0.007s\n\n# åªæƒ³è¿è¡Œå…¶ä¸­çš„ä¸€ä¸ªç”¨ä¾‹\n$ go test -run TestAdd -v\n=== RUN   TestAdd\n--- PASS: TestAdd (0.00s)\nPASS\nok      example 0.007s\n```\n\n## å•å…ƒæµ‹è¯•\n\nè¿è¡Œ `go testing` ä¼šæ‰«æå¹¶ç¼–è¯‘è¿è¡Œå·¥ç¨‹ç›®å½•ä¸‹ `xxx_test.go` ä»£ç æ–‡ä»¶ä¸­çš„ `TestXxx` æµ‹è¯•å‡½æ•°ã€‚\n\n- æµ‹è¯•ä»£ç æ–‡ä»¶å `xxx_test.go`ï¼Œå¿…é¡»éµå®ˆã€‚\n- æµ‹è¯•å‡½æ•°ç­¾å `TestXxx(t *testing.T)`ï¼Œå¿…é¡»éµå®ˆã€‚\n\n```sh\n# å½“å‰ç›®å½•ï¼ˆæŸç›®å½•ï¼‰æŸ¥æ‰¾ xxx_test.go æµ‹è¯•ä»£ç \ngo test .\ngo test ./xxx/xxx\n\n# å½“å‰ç›®å½•ï¼ˆæŸç›®å½•ï¼‰ä»¥åŠå­ç›®å½•ä¸‹æ‰€çš„ xxx_test.go æµ‹è¯•ä»£ç \ngo test ./...\ngo test ./xxx/xxx/...\n\n# -v å‚æ•°ï¼Œæ‰“å¼€ç»ˆç«¯ä¿¡æ¯æ‰“å°çš„å¼€å…³ã€‚\n# æµ‹è¯•ä»£ç ä¸­çš„æ‰“å°å‡½æ•°ï¼ˆt.Logã€t.Skipã€t.Errorã€t.Fatalï¼‰\n# fmt.Print åªä¼šåœ¨ä»»ä¸€æµ‹è¯•å‡½æ•°ä¸º FAIL æ—¶ï¼Œä¿¡æ¯æ‰ä¼šæ˜¾ç¤ºã€‚\ngo test . -v\n\n# -run ç”¨æ¥æŒ‡å®šæ‰§è¡ŒæŸä¸ª TestXXX å•å…ƒæµ‹è¯•å‡½æ•°ï¼Œæ”¯æŒä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…æµ‹è¯•å‡½æ•°åç§°ã€‚\n# åƒ TestMainã€init() è¿™ç±»æ¡†æ¶æ€§ä»£ç ä»ç„¶ä¼šè¢«æ‰§è¡Œï¼Œä»¥ç¡®ä¿ç¯å¢ƒæ­£ç¡®ã€‚\ngo test -run ^TestXxx$\n```\n\n```go\n// youwu_test.go\n// å…¶å® t.Error ç­‰åŒäº t.Log + t.Failï¼Œå½“åªæ ‡è®°é”™è¯¯ä¸æ‰“å°ä¿¡æ¯æ—¶ï¼Œä½¿ç”¨t.Failã€‚\n// æ‰“å°çš„å‡½æ•° `t.Log`ã€`t.Error`ã€`t.Fatal` éƒ½æœ‰å¯¹åº”çš„æ ¼å¼åŒ–å½¢å¼ `t.Logf`ã€`t.Errorf`ã€`t.Fatalf`\npackage main_test\n\nimport (\n    \"fmt\"\n    \"testing\"\n)\nfunc TestWorld(t *testing.T) {\n    t.Log(\"TestWorlds\")\n}\n\n// åˆå§‹åŒ– init æ–¹å¼\nfunc init() {\n    fmt.Println(\"hello, i'm \\\"init\\\".\")\n}\n\n// ä½¿ç”¨ t å®ä¾‹çš„ Cleanup æ–¹æ³•æ³¨å†Œä¸€ä¸ªåœ¨å•å…ƒæµ‹è¯•ç¨‹åºé€€å‡ºå‰æ‰§è¡Œçš„å‡½æ•°ã€‚\n// åŒ…çº§åˆ«ï¼šä½¿ç”¨ TestMain æ¨¡å¼ã€‚\nfunc cleanuptest() {\n    fmt.Println(\"Cleanup.ğŸ˜€\")\n}\nfunc TestClean(t *testing.T) {\n    t.Cleanup(cleanuptest)\n    t.Log(\"testing done.\")\n}\n```\n\n```sh\n...\n=== RUN   TestReportError\n    youwu_test.go:42: report in: t.Error\n--- FAIL: TestReportError (0.00s)\n...\nexit status 1\nFAIL    hellotest       0.498s\n```\n\n```go\n// è·³å‡ºå½“å‰å•å…ƒæµ‹è¯•å‡½æ•°ï¼ŒçŠ¶æ€ä¸ºè·³å‡ºï¼ˆSKIPï¼Œä¸è®¡ä¸ºå¤±è´¥ï¼‰ï¼Œæ‰§è¡Œä¸‹ä¸€ä¸ªæµ‹è¯•å‡½æ•°\nt.SkipNow()\n\n// .Log -\u003e t.SkipNow æ‰“å°å¹¶è·³å‡ºå½“å‰å•å…ƒæµ‹è¯•å‡½æ•°\nt.Skip(\"ä¿¡æ¯\")\n\n// æ ‡è®°å½“å‰å•å…ƒæµ‹è¯•å‡½æ•°çŠ¶æ€ä¸ºé”™è¯¯ï¼ˆFAILEDï¼‰ï¼Œç»§ç»­æ‰§è¡Œ\nt.Fail()\n\n// æ ‡è®°å½“å‰å•å…ƒæµ‹è¯•å‡½æ•°çŠ¶æ€ä¸ºé”™è¯¯ï¼ˆFAILEDï¼‰å¹¶è·³å‡ºï¼Œæ‰§è¡Œä¸‹ä¸€ä¸ªæµ‹è¯•å‡½æ•°\nt.FailNow()\n\n// t.Log(ä¿¡æ¯) -\u003e t.Fail()ï¼Œè¯¥å•å…ƒæµ‹è¯•ä¼šç»§ç»­æ‰§è¡Œ\nt.Error(\"ä¿¡æ¯\")\n\n// t.Log(ä¿¡æ¯) -\u003e t.FailNow()ï¼Œè·³å‡ºè¯¥å•å…ƒæµ‹è¯•ï¼Œæ‰§è¡Œä¸‹ä¸€ä¸ªå•å…ƒæµ‹è¯•å‡½æ•°\nt.Fatal(\"ä¿¡æ¯\")\n```\n\n## å­æµ‹è¯•\n\n```go\n// calc_test.go\n// t.Error/t.Errorf é‡é”™ä¸åœï¼Œè¿˜ä¼šç»§ç»­æ‰§è¡Œå…¶ä»–çš„æµ‹è¯•ç”¨ä¾‹\n// t.Fatal/t.Fatalf é‡é”™å³åœ\nfunc TestMul(t *testing.T) {\n\tt.Run(\"pos\", func(t *testing.T) {\n\t\tif Mul(2, 3) != 6 {\n\t\t\tt.Fatal(\"fail\")\n\t\t}\n\n\t})\n\tt.Run(\"neg\", func(t *testing.T) {\n\t\tif Mul(2, -3) != -6 {\n\t\t\tt.Fatal(\"fail\")\n\t\t}\n\t})\n}\n```\n\nå¯¹äºå¤šä¸ªå­æµ‹è¯•çš„åœºæ™¯ï¼Œæ›´æ¨èå¦‚ä¸‹çš„å†™æ³•(table-driven tests)ï¼š\nå¦‚æœæ•°æ®é‡è¾ƒå¤§ï¼Œæˆ–æ˜¯ä¸€äº›äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¨èä½¿ç”¨ç›¸å¯¹è·¯å¾„ä»æ–‡ä»¶ä¸­è¯»å–ã€‚\n\n```go\n//  calc_test.go\nfunc TestMul(t *testing.T) {\n\tcases := []struct {\n\t\tName           string\n\t\tA, B, Expected int\n\t}{\n\t\t{\"pos\", 2, 3, 6},\n\t\t{\"neg\", 2, -3, -6},\n\t\t{\"zero\", 2, 0, 0},\n\t}\n\n\tfor _, c := range cases {\n\t\tt.Run(c.Name, func(t *testing.T) {\n\t\t\tif ans := Mul(c.A, c.B); ans != c.Expected {\n\t\t\t\tt.Fatalf(\"%d * %d expected %d, but %d got\",\n\t\t\t\t\tc.A, c.B, c.Expected, ans)\n\t\t\t}\n\t\t})\n\t}\n}\n```\n\n## å¸®åŠ©å‡½æ•°\n\nGo è¯­è¨€åœ¨ 1.9 ç‰ˆæœ¬ä¸­å¼•å…¥äº† `t.Helper()`ï¼Œç”¨äºæ ‡æ³¨è¯¥å‡½æ•°æ˜¯å¸®åŠ©å‡½æ•°ï¼Œ\næŠ¥é”™æ—¶å°†è¾“å‡ºå¸®åŠ©å‡½æ•°è°ƒç”¨è€…çš„ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å¸®åŠ©å‡½æ•°çš„å†…éƒ¨ä¿¡æ¯ã€‚\n\nå…³äº helper å‡½æ•°çš„ 2 ä¸ªå»ºè®®ï¼š\n\n- ä¸è¦è¿”å›é”™è¯¯ï¼Œ å¸®åŠ©å‡½æ•°å†…éƒ¨ç›´æ¥ä½¿ç”¨ t.Error æˆ– t.Fatal å³å¯ï¼Œ\n- è°ƒç”¨ t.Helper() è®©æŠ¥é”™ä¿¡æ¯æ›´å‡†ç¡®ï¼Œæœ‰åŠ©äºå®šä½ã€‚\n\n```go\n// calc_test.go\npackage main\n\nimport \"testing\"\n\ntype calcCase struct{ A, B, Expected int }\n\nfunc createMulTestCase(t *testing.T, c *calcCase) {\n\tt.Helper()\n\tif ans := Mul(c.A, c.B); ans != c.Expected {\n\t\tt.Fatalf(\"%d * %d expected %d, but %d got\",\n\t\t\tc.A, c.B, c.Expected, ans)\n\t}\n\n}\n\nfunc TestMul(t *testing.T) {\n\tcreateMulTestCase(t, \u0026calcCase{2, 3, 6})\n\tcreateMulTestCase(t, \u0026calcCase{2, -3, -6})\n\tcreateMulTestCase(t, \u0026calcCase{2, 0, 1}) // wrong case\n}\n```\n\n## TestMain æ–¹å¼\n\n`TestMain` æ˜¯ `go testing` æµ‹è¯•æ¡†æ¶çš„æŒ‡å®šå‡½æ•°ã€‚\nç”¨äºæ§åˆ¶æ•´ä¸ªæµ‹è¯•è¿‡ç¨‹ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯åŒ…çº§åˆ«çš„ã€‚\nå³ä¸€ä¸ªåŒ…ä¸‹ï¼Œå¦‚æœæœ‰å¤šä¸ª `xxx_test.go` æµ‹è¯•ä»£ç ï¼Œåªèƒ½åœ¨å…¶ä¸­æŸä¸ª `xxx_test.go` ä¸­å®šä¹‰ã€‚\n\n```go\n// youwu_test.go\npackage main_test\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"testing\"\n)\n\nfunc TestHello(t *testing.T) {\n    t.Log(\"TestHello\")\n}\n\n// func TestWorld(t *testing.T) {\n//  t.Log(\"TestWorlds\")\n// }\n\nfunc cleanuptest() {\n    fmt.Println(\"Cleanup.ğŸ˜€\")\n}\nfunc TestClean(t *testing.T) {\n    t.Cleanup(cleanuptest)\n    t.Log(\"testing done.\")\n}\n\nfunc init() {\n    fmt.Println(\"hello, i'm \\\"init\\\".\")\n}\n\nfunc TestMain(m *testing.M) {\n    // åœ¨å¼€å§‹è¿è¡Œå•å…ƒæµ‹è¯•ä»£ç ä¹‹å‰\n    // å¯ä»¥åœ¨æ­¤å¤„æ·»åŠ ç¯å¢ƒåˆå§‹åŒ–ç›¸å…³ä»£ç æˆ–è€…å‡½æ•°è°ƒç”¨\n    fmt.Println(\"ğŸ˜€ å¼€å§‹æ‰€æœ‰æµ‹è¯•å‰\")\n\n    retCode := m.Run()\n\n    // åœ¨å…¨éƒ¨æµ‹è¯•ä»£ç è¿è¡Œç»“æŸé€€å‡ºä¹‹å‰\n    // å¯ä»¥åœ¨æ­¤å¤„æ·»åŠ æ¸…ç†ä»£ç æˆ–å‡½æ•°è°ƒç”¨\n    fmt.Println(\"ğŸ˜€ ç»“æŸæ‰€æœ‰æµ‹è¯•å‰\")\n\n    os.Exit(retCode)\n}\n```\n\n```sh\n~/Projects/go/examples/hellotest\nâœ  go test -v\nhello, i'm \"init\".\nğŸ˜€ å¼€å§‹æ‰€æœ‰æµ‹è¯•å‰\n=== RUN   TestHello\n    youwu_test.go:10: TestHello\n--- PASS: TestHello (0.00s)\n=== RUN   TestClean\n    youwu_test.go:22: testing done.\nCleanup.ğŸ˜€\n--- PASS: TestClean (0.00s)\nPASS\nğŸ˜€ ç»“æŸæ‰€æœ‰æµ‹è¯•å‰\nok      hellotest       0.369s\n```\n\n## benckmark æ€§èƒ½åŸºå‡†æµ‹è¯•\n\nå¤šæ¬¡è¿è¡Œï¼Œå¹¶è®¡ç®—å…¶å¹³å‡æ‰§è¡Œæ—¶é—´ä»è€Œè¯„ä¼°å…¶è¿è¡Œæ•ˆç‡ã€‚\ngo æ€§èƒ½åŸºå‡†æµ‹è¯•ä»£ç çš„å‡½æ•°å‘½åï¼š\n\n- `func BenchmarkXxx(*testing.T)`\n\nåŸºå‡†æµ‹è¯•æŠ¥å‘Šæ¯ä¸€åˆ—å€¼å¯¹åº”çš„å«ä¹‰å¦‚ä¸‹ï¼š\n\n```go\ntype BenchmarkResult struct {\n    N         int           // è¿­ä»£æ¬¡æ•°\n    T         time.Duration // åŸºå‡†æµ‹è¯•èŠ±è´¹çš„æ—¶é—´\n    Bytes     int64         // ä¸€æ¬¡è¿­ä»£å¤„ç†çš„å­—èŠ‚æ•°\n    MemAllocs uint64        // æ€»çš„åˆ†é…å†…å­˜çš„æ¬¡æ•°\n    MemBytes  uint64        // æ€»çš„åˆ†é…å†…å­˜çš„å­—èŠ‚æ•°\n}\n```\n\n```go\n// youwu_test.go\npackage main_test\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"os\"\n    \"testing\"\n)\n\nfunc TestHello(t *testing.T) {\n    t.Log(\"TestHello\")\n}\n\nfunc init() {\n    fmt.Println(\"hello, i'm \\\"init\\\".\")\n}\n\nfunc TestMain(m *testing.M) {\n    // åœ¨å¼€å§‹è¿è¡Œå•å…ƒæµ‹è¯•ä»£ç ä¹‹å‰\n    // å¯ä»¥åœ¨æ­¤å¤„æ·»åŠ ç¯å¢ƒåˆå§‹åŒ–ç›¸å…³ä»£ç æˆ–è€…å‡½æ•°è°ƒç”¨\n    fmt.Println(\"ğŸ˜€ å¼€å§‹æ‰€æœ‰æµ‹è¯•å‰\")\n\n    retCode := m.Run()\n\n    // åœ¨å…¨éƒ¨æµ‹è¯•ä»£ç è¿è¡Œç»“æŸé€€å‡ºä¹‹å‰\n    // å¯ä»¥åœ¨æ­¤å¤„æ·»åŠ æ¸…ç†ä»£ç æˆ–å‡½æ•°è°ƒç”¨\n    fmt.Println(\"ğŸ˜€ ç»“æŸæ‰€æœ‰æµ‹è¯•å‰\")\n\n    os.Exit(retCode)\n}\n\nfunc BenchmarkRandInt(b *testing.B) {\n    for i := 0; i \u003c b.N; i++ {\n        rand.Int()\n    }\n}\n```\n\n```sh\n~/Projects/go/examples/hellotest\nâœ  go test -bench='Rand' -v .\nhello, i'm \"init\".\nğŸ˜€ å¼€å§‹æ‰€æœ‰æµ‹è¯•å‰\n=== RUN   TestHello\n    youwu_test.go:19: TestHello\n--- PASS: TestHello (0.00s)\ngoos: darwin\ngoarch: amd64\npkg: hellotest\ncpu: Intel(R) Core(TM) i5-7500 CPU @ 3.40GHz\nBenchmarkRandInt\nBenchmarkRandInt-4      70186930                16.21 ns/op\nPASS\nğŸ˜€ ç»“æŸæ‰€æœ‰æµ‹è¯•å‰\nok      hellotest       1.476s\n```\n\nå¯ä»¥ä½¿ç”¨ b.ResetTimer() å…ˆé‡ç½®å®šæ—¶å™¨\n\n```go\nfunc BenchmarkHello(b *testing.B) {\n    ... // è€—æ—¶æ“ä½œ\n    b.ResetTimer()\n    for i := 0; i \u003c b.N; i++ {\n        fmt.Sprintf(\"hello\")\n    }\n}\n```\n\nä½¿ç”¨ RunParallel æµ‹è¯•å¹¶å‘æ€§èƒ½\n\n```go\nfunc BenchmarkParallel(b *testing.B) {\n\ttempl := template.Must(template.New(\"test\").Parse(\"Hello, {{.}}!\"))\n\tb.RunParallel(func(pb *testing.PB) {\n\t\tvar buf bytes.Buffer\n\t\tfor pb.Next() {\n\t\t\t// æ‰€æœ‰ goroutine ä¸€èµ·ï¼Œå¾ªç¯ä¸€å…±æ‰§è¡Œ b.N æ¬¡\n\t\t\tbuf.Reset()\n\t\t\ttempl.Execute(\u0026buf, \"World\")\n\t\t}\n\t})\n}\n```\n"},{"name":"rust.md","baseName":"rust","extName":".md","fullPath":"/special/test/rust.md","content":"## æµ‹è¯•å‡½æ•°ï¼ˆæµ‹è¯•ç”¨ä¾‹ï¼‰\n\n```rust\npub fn greeting(name: \u0026str) -\u003e String {\n    format!(\"Hello {}!\", name)\n}\n\npub struct Guess {\n    value: i32,\n}\n\nimpl Guess {\n    pub fn new(value: i32) -\u003e Guess {\n        if value \u003c 1 || value \u003e 100 {\n            panic!(\"Guess value must be between 1 and 100, got {}.\", value);\n        }\n\n        Guess { value }\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    // åŸºæœ¬æµ‹è¯•\n    #[test]\n    fn it_works() {\n        assert_eq!(2 + 2, 4);\n    }\n\n    // æµ‹è¯•å¤±è´¥\n    #[test]\n    fn another() {\n        panic!(\"Make this test fail\");\n    }\n\n    // è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯\n    // ä»»ä½•åœ¨ assert! çš„ä¸€ä¸ªå¿…éœ€å‚æ•°å’Œ assert_eq! å’Œ assert_ne!\n    // çš„ä¸¤ä¸ªå¿…éœ€å‚æ•°ä¹‹åæŒ‡å®šçš„å‚æ•°éƒ½ä¼šä¼ é€’ç»™ format! å®\n    #[test]\n    fn greeting_contains_name() {\n        let result = greeting(\"Sunface\");\n        let target = \"å­™é£\";\n        assert!(\n            result.contains(target),\n            \"ä½ çš„é—®å€™ä¸­å¹¶æ²¡æœ‰åŒ…å«ç›®æ ‡å§“å {} ï¼Œä½ çš„é—®å€™æ˜¯ {}\",\n            target,\n            result\n        );\n    }\n\n    // æµ‹è¯•panic\n    // å¯ä»¥ç»™ should_panic å±æ€§å¢åŠ ä¸€ä¸ªå¯é€‰çš„ expected å‚æ•°\n    #[test]\n    #[should_panic(expected = \"Guess value must be less than or equal to 100\")]\n    fn greater_than_100() {\n        Guess::new(200);\n    }\n\n    // ä½¿ç”¨ Result\u003cT, E\u003e\n    // ä¸åŒäºè°ƒç”¨ assert_eq! å®\n    // æµ‹è¯•é€šè¿‡æ—¶è¿”å› Ok(())ï¼Œåœ¨æµ‹è¯•å¤±è´¥æ—¶è¿”å›å¸¦æœ‰ String çš„ Err\n    #[test]\n    fn it_works() -\u003e Result\u003c(), String\u003e {\n        if 2 + 2 == 4 {\n            Ok(())\n        } else {\n            Err(String::from(\"two plus two does not equal four\"))\n        }\n    }\n\n    // å¿½ç•¥æµ‹è¯•\n    #[test]\n    #[ignore]\n    fn expensive_test() {\n        // è¿™é‡Œçš„ä»£ç éœ€è¦å‡ åç§’ç”šè‡³å‡ åˆ†é’Ÿæ‰èƒ½å®Œæˆ\n    }\n}\n```\n\n```rust\n// assert_eq! å’Œ assert_ne!ã€‚è¿™ä¸¤ä¸ªå®åˆ†åˆ«æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯ç›¸ç­‰è¿˜æ˜¯ä¸ç›¸ç­‰ã€‚\n// assert_eq! å’Œ assert_ne! å®åœ¨åº•å±‚åˆ†åˆ«ä½¿ç”¨äº† == å’Œ !=ã€‚\n// å½“æ–­è¨€å¤±è´¥æ—¶ï¼Œè¿™äº›å®ä¼šä½¿ç”¨è°ƒè¯•æ ¼å¼æ‰“å°å‡ºå…¶å‚æ•°ï¼Œ\n// è¿™æ„å‘³ç€è¢«æ¯”è¾ƒçš„å€¼å¿…éœ€å®ç°äº† PartialEq å’Œ Debug trait\npub fn add_two(a: i32) -\u003e i32 {\n    a + 2\n}\n#[cfg(test)]\nmod tests {\n    use super::*;\n    #[test]\n    fn it_adds_two() {\n        assert_eq!(4, add_two(2));\n    }\n    #[test]\n    fn it_adds_tree() {\n        assert_ne!(4, add_two(3));\n    }\n}\n```\n\n```sh\ncargo test\n\n# ä½¿ç”¨ -- åˆ†å‰²å‘½ä»¤è¡Œå‚æ•°\n# ç¬¬ä¸€ç§æ˜¯æä¾›ç»™ cargo test å‘½ä»¤æœ¬èº«çš„ï¼Œè¿™äº›å‚æ•°åœ¨ -- ä¹‹å‰æŒ‡å®š\n# ç¬¬äºŒç§æ˜¯æä¾›ç»™ç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶çš„ï¼Œåœ¨ -- ä¹‹åæŒ‡å®š\ncargo test --help\ncargo test -- --help\n\n# æ˜¾ç¤ºæµ‹è¯•å‡½æ•°ä¸­çš„ println!\ncargo test -- --show-output\n\n# è¿è¡Œå•ä¸ªæµ‹è¯•\ncargo test one_hundred\n\n# é€šè¿‡åç§°æ¥è¿‡æ»¤æµ‹è¯•ï¼ˆåç§°ä¸­å¸¦addï¼‰\ncargo test add\n\n# è¿è¡Œè¢«å¿½ç•¥çš„æµ‹è¯•å‡½æ•°\ncargo test -- --ignored\n# è¿è¡Œåç§°ä¸­å¸¦ run ä¸”è¢«å¿½ç•¥çš„æµ‹è¯•å‡½æ•°\ncargo test run -- --ignored\n\n# æµ‹è¯•é€šè¿‡æ˜¯æ‰“å°å†…å®¹ä¼šè¢«æˆªè·å¿½ç•¥ï¼Œå¤±è´¥æ‰æ˜¾ç¤ºã€‚\n# æˆªè·è¾“å‡ºçš„è¡Œä¸ºå¯ä»¥é€šè¿‡ --nocapture å‚æ•°æ¥ç¦ç”¨\ncargo test -- --nocapture\n```\n\n## å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•\n\nå•å…ƒæµ‹è¯•ï¼ˆunit testsï¼‰ä¸ é›†æˆæµ‹è¯•ï¼ˆintegration testsï¼‰ã€‚\n\n- å•å…ƒæµ‹è¯•å€¾å‘äºæ›´å°è€Œæ›´é›†ä¸­ï¼Œåœ¨éš”ç¦»çš„ç¯å¢ƒä¸­ä¸€æ¬¡æµ‹è¯•ä¸€ä¸ªæ¨¡å—ï¼Œæˆ–è€…æ˜¯æµ‹è¯•ç§æœ‰æ¥å£ã€‚\n  - å•å…ƒæµ‹è¯•æ˜¯è·Ÿæ­£å¸¸çš„é€»è¾‘ä»£ç åœ¨åŒä¸€ä¸ªæ–‡ä»¶ï¼Œå› æ­¤å¿…é¡»å¯¹å…¶è¿›è¡Œç‰¹æ®Šçš„æ ‡æ³¨ï¼Œä»¥ä¾¿ Rust å¯ä»¥è¯†åˆ«ã€‚\n  - è§„èŒƒæ˜¯åœ¨æ¯ä¸ªæ–‡ä»¶ä¸­åˆ›å»ºåŒ…å«æµ‹è¯•å‡½æ•°çš„ `tests` æ¨¡å—ï¼Œå¹¶ä½¿ç”¨ `cfg(test)` æ ‡æ³¨æ¨¡å—\n- è€Œé›†æˆæµ‹è¯•å¯¹äºä½ çš„åº“æ¥è¯´åˆ™å®Œå…¨æ˜¯å¤–éƒ¨çš„ã€‚\n  - é›†æˆæµ‹è¯•çš„ç›®çš„æ˜¯æµ‹è¯•åº“çš„å¤šä¸ªéƒ¨åˆ†èƒ½å¦ä¸€èµ·æ­£å¸¸å·¥ä½œã€‚\n  - å®ƒä»¬ä¸å…¶ä»–å¤–éƒ¨ä»£ç ä¸€æ ·ï¼Œé€šè¿‡ç›¸åŒçš„æ–¹å¼ä½¿ç”¨ä½ çš„ä»£ç ï¼Œåªæµ‹è¯•å…¬æœ‰æ¥å£è€Œä¸”æ¯ä¸ªæµ‹è¯•éƒ½æœ‰å¯èƒ½ä¼šæµ‹è¯•å¤šä¸ªæ¨¡å—ã€‚\n    - é›†æˆæµ‹è¯•è¢«æ”¾å…¥å•ç‹¬çš„ç›®å½•æ–‡ä»¶ä¸­\n    - ä¸éœ€è¦åˆ›å»ºæµ‹è¯•æ¨¡å—åŠæ ‡æ³¨ `#[cfg(test)]`\n    - åªèƒ½è°ƒç”¨é€šè¿‡ pub å®šä¹‰çš„ API\n    - ä¸€ä¸ªæ ‡å‡†çš„ Rust é¡¹ç›®ï¼Œåœ¨å®ƒçš„æ ¹ç›®å½•ä¸‹ä¼šæœ‰ä¸€ä¸ª `tests` ç›®å½•ï¼Œä¸ `src` åŒçº§ã€‚\n    - åœ¨é›†æˆæµ‹è¯•çš„ tests ç›®å½•ä¸‹ï¼Œæ¯ä¸€ä¸ªæ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åŒ…\n\nRust åªæ”¯æŒå¯¹ lib ç±»å‹çš„åŒ…è¿›è¡Œé›†æˆæµ‹è¯•ï¼Œå¯¹äºäºŒè¿›åˆ¶åŒ…ä¾‹å¦‚ `src/main.rs` æ˜¯æ— èƒ½ä¸ºåŠ›çš„ã€‚\nåŸå› åœ¨äºï¼Œæˆ‘ä»¬æ— æ³•åœ¨å…¶å®ƒåŒ…ä¸­ä½¿ç”¨ use å¼•å…¥äºŒè¿›åˆ¶åŒ…ï¼Œè€Œåªæœ‰ lib ç±»å‹çš„åŒ…æ‰èƒ½è¢«å¼•å…¥ï¼Œä¾‹å¦‚ `src/lib.rs`\n\né›†æˆæµ‹è¯•ç¤ºä¾‹ï¼š\n\n```rust\n// tests/integration_test.rs\nuse adder;\n\nmod common;\n\n#[test]\nfn it_adds_two() {\n    common::setup();\n    assert_eq!(4, adder::add_two(2));\n}\n```\n\n```rust\n// tests/common/mod.rs\n// å¸Œæœ›è¿™ä¸ªå‡½æ•°èƒ½è¢«å¤šä¸ªæµ‹è¯•æ–‡ä»¶çš„æµ‹è¯•å‡½æ•°è°ƒç”¨\npub fn setup() {\n    // ç¼–å†™ç‰¹å®šåº“æµ‹è¯•æ‰€éœ€çš„ä»£ç \n}\n```\n\nå•å…ƒæµ‹è¯•çš„å…±äº«æ¨¡å—è·¯å¾„\n\n- `tests/common.rs`\n- `tests/common/mod.rs`\n  - è¿™æ ·å‘½åå‘Šè¯‰ Rust ä¸è¦å°† common çœ‹ä½œä¸€ä¸ªé›†æˆæµ‹è¯•æ–‡ä»¶\n\n```sh\n# è¿è¡ŒæŸä¸ªç‰¹å®šé›†æˆæµ‹è¯•æ–‡ä»¶ä¸­çš„æ‰€æœ‰æµ‹è¯•\ncargo test --test integration_test\n```\n\n## æµ‹è¯•æ‰å¼•å…¥çš„åŒ…\n\n`Cargo.toml`\n\n```toml\n# standard crate data is left out\n[dev-dependencies]\npretty_assertions = \"1\"\n```\n\n```rust\npub fn add(a: i32, b: i32) -\u003e i32 {\n    a + b\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use pretty_assertions::assert_eq; // è¯¥åŒ…ä»…èƒ½ç”¨äºæµ‹è¯•\n\n    #[test]\n    fn test_add() {\n        assert_eq!(add(2, 3), 5);\n    }\n}\n```\n\n## æ–­è¨€\n\n- æ‰€æœ‰æ¨¡å¼ä¸‹è¿è¡Œ\n  - `assert!`\n  - `assert_eq!`\n  - `assert_ne!`\n- Debug æ¨¡å¼ä¸‹è¿è¡Œ\n  - `debug_assert!`\n  - `debug_assert_eq!`\n  - `debug_assert_ne!`\n\n## benckmark åŸºå‡†æµ‹è¯•\n\næ€§èƒ½æµ‹è¯•åŒ…å«äº†ä¸¤ç§ï¼šå‹åŠ›æµ‹è¯•å’ŒåŸºå‡†æµ‹è¯•\n\n- å‰è€…æ˜¯é’ˆå¯¹æ¥å£ APIï¼Œæ¨¡æ‹Ÿå¤§é‡ç”¨æˆ·å»è®¿é—®æ¥å£ç„¶åç”Ÿæˆæ¥å£çº§åˆ«çš„æ€§èƒ½æ•°æ®ï¼›\n- è€Œåè€…æ˜¯é’ˆå¯¹ä»£ç ï¼Œå¯ä»¥ç”¨æ¥æµ‹è¯•æŸä¸€æ®µä»£ç çš„è¿è¡Œé€Ÿåº¦ï¼Œä¾‹å¦‚ä¸€ä¸ªæ’åºç®—æ³•ã€‚\n\nå®˜æ–¹æä¾›çš„æµ‹è¯•å·¥å…·ï¼Œç›®å‰æœ€å¤§çš„é—®é¢˜å°±æ˜¯åªèƒ½åœ¨é stable ä¸‹ä½¿ç”¨ï¼Œ\nåŸå› æ˜¯éœ€è¦åœ¨ä»£ç ä¸­å¼•å…¥ test ç‰¹æ€§: `#![feature(test)]`\n\néœ€è¦å…ˆå°†å½“å‰ä»“åº“ä¸­çš„ Rust ç‰ˆæœ¬ä» stable åˆ‡æ¢ä¸º nightly:\n\n- å®‰è£… nightly ç‰ˆæœ¬ï¼š\\$ `rustup install nightly`\n- ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¡®è®¤ç‰ˆæœ¬å·²ç»å®‰è£…æˆåŠŸ `rustup toolchain list`\n- è¿›å…¥ adder é¡¹ç›®(ä¹‹å‰ä¸ºäº†å­¦ä¹ æµ‹è¯•ä¸“é—¨åˆ›å»ºçš„é¡¹ç›®)çš„æ ¹ç›®å½•ï¼Œç„¶åè¿è¡Œ `rustup override set nightly`ï¼Œå°†è¯¥é¡¹ç›®ä½¿ç”¨çš„ rust è®¾ç½®ä¸º nightly\n  - ä½¿ç”¨ `rustup override set stable` åˆ‡æ¢å› stable ç‰ˆæœ¬\n\n```rust\n// src/lib.rs\n#![feature(test)]\n\nextern crate test;\n\npub fn add_two(a: i32) -\u003e i32 {\n    a + 2\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use test::Bencher;\n\n    #[test]\n    fn it_works() {\n        assert_eq!(4, add_two(2));\n    }\n\n    #[bench]\n    fn bench_add_two(b: \u0026mut Bencher) {\n        b.iter(|| add_two(2));\n    }\n}\n```\n\n```rust\n#![feature(test)]\n\nextern crate test;\n\nfn fibonacci_u64(number: u64) -\u003e u64 {\n    let mut last: u64 = 1;\n    let mut current: u64 = 0;\n    let mut buffer: u64;\n    let mut position: u64 = 1;\n\n    return loop {\n        if position == number {\n            break current;\n        }\n\n        buffer = last;\n        last = current;\n        current = buffer + current;\n        position += 1;\n    };\n}\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use test::Bencher;\n\n    #[test]\n    fn it_works() {\n       assert_eq!(fibonacci_u64(1), 0);\n       assert_eq!(fibonacci_u64(2), 1);\n       assert_eq!(fibonacci_u64(12), 89);\n       assert_eq!(fibonacci_u64(30), 514229);\n    }\n\n    #[bench]\n    fn bench_u64(b: \u0026mut Bencher) {\n        b.iter(|| {\n            for i in 100..200 {\n                // LLVMè®¤ä¸ºfibonacci_u64å‡½æ•°è°ƒç”¨çš„ç»“æœæ²¡æœ‰ä½¿ç”¨ï¼Œ\n                // åŒæ—¶ä¹Ÿè®¤ä¸ºè¯¥å‡½æ•°æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨(é€ æˆå…¶å®ƒçš„å½±å“ï¼Œä¾‹å¦‚ä¿®æ”¹å¤–éƒ¨å˜é‡ã€è®¿é—®ç½‘ç»œç­‰),\n                // å› æ­¤å®ƒæœ‰ç†ç”±æŠŠè¿™ä¸ªå‡½æ•°è°ƒç”¨ä¼˜åŒ–æ‰ï¼\n                // fibonacci_u64(i);\n                test::black_box(fibonacci_u64(test::black_box(i)));\n            }\n        });\n    }\n}\n```\n\n```sh\ncargo bench\n```\n"}]}},"page":"/[...param]","query":{"param":["special","test"]},"buildId":"S-jJrz2DKYE9I2Mqo2Xou","assetPrefix":"/comparison-note","nextExport":true,"isFallback":false,"gip":true,"head":[["meta",{"name":"viewport","content":"width=device-width"}],["meta",{"charSet":"utf-8"}],["title",{"children":"è‡ªåŠ¨åŒ–æµ‹è¯•"}]]}</script><script nomodule="" src="/comparison-note/_next/static/chunks/polyfills-7258ef49cf482e03ae9c.js"></script><script src="/comparison-note/_next/static/chunks/main-14614ae8e939b9e5961e.js" async=""></script><script src="/comparison-note/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/comparison-note/_next/static/chunks/framework.c7b20b4e446c7cca89e7.js" async=""></script><script src="/comparison-note/_next/static/chunks/7945cc82.ff5578978733a40a67a3.js" async=""></script><script src="/comparison-note/_next/static/chunks/commons.a32a113e095d8f0b1079.js" async=""></script><script src="/comparison-note/_next/static/chunks/pages/_app-1832d2b05f1f19d6a06d.js" async=""></script><script src="/comparison-note/_next/static/chunks/a1bc03cf.64f9f8493143216945e6.js" async=""></script><script src="/comparison-note/_next/static/chunks/4d6c67b811e74d3ca6630b1db854b02fef4ff3ce.8a4303f940dd12850a8f.js" async=""></script><script src="/comparison-note/_next/static/chunks/pages/%5B...param%5D-ec17b069b047a5ce78c3.js" async=""></script><script src="/comparison-note/_next/static/S-jJrz2DKYE9I2Mqo2Xou/_buildManifest.js" async=""></script><script src="/comparison-note/_next/static/S-jJrz2DKYE9I2Mqo2Xou/_ssgManifest.js" async=""></script></body></html>